{"version":3,"sources":["../server/api.js"],"names":["router","Router","put","req","res","query","sensorId","sensorKey","sensorState","console","error","status","end","sensorLat","Lat","sensorLng","Lng","sensorType","Type","putEvent","then","result","json","catch","post","registerDevice","params","get","getDevice","module","exports"],"mappings":"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","file":"api.js","sourcesContent":["import express from 'express';\nimport device from './device';\n\nconst router = express.Router();\n\nrouter.put('/event', (req, res) => {\n  if (!req.query.sensorId || !req.query.sensorKey || !req.query.sensorState) {\n    console.error('error put event: required query parameters not found');\n    console.error('>> query: ', req.query);\n    res.status(400).end();\n  }\n\n  if (!req.query.sensorLat) req.query.Lat = 52.1698721;\n  if (!req.query.sensorLng) req.query.Lng = 21.0151143;\n  if (!req.query.sensorType) req.query.Type = 'f0f4371a-9b18-4755-aa89-d5a7152e6525';\n\n  device.putEvent(req.query.sensorId, req.query.sensorKey, req.query.sensorState, req.query.sensorLat, req.query.sensorLng, req.query.sensorType).then((result) => {\n    if (!result) {\n      res.status(409).end();\n    } else {\n      res.json(result);\n    }\n  }).catch((error) => {\n    console.error(error);\n    res.status(409).end();\n  });\n});\n\nrouter.post('/event', (req, res) => {\n  if (!req.query.sensorId || !req.query.sensorKey || !req.query.sensorState) {\n    console.error('error put event: required query parameters not found');\n    console.error('>> query: ', req.query);\n    res.status(400).end();\n  }\n\n  if (!req.query.sensorLat) req.query.Lat = 52.1698721;\n  if (!req.query.sensorLng) req.query.Lng = 21.0151143;\n  if (!req.query.sensorType) req.query.Type = 'f0f4371a-9b18-4755-aa89-d5a7152e6525';\n\n  device.putEvent(req.query.sensorId, req.query.sensorKey, req.query.sensorState, req.query.sensorLat, req.query.sensorLng, req.query.sensorType).then((result) => {\n    if (!result) {\n      res.status(409).end();\n    } else {\n      res.json(result);\n    }\n  }).catch((error) => {\n    console.error(error);\n    res.status(409).end();\n  });\n});\n\nrouter.put('/device/:sensorId', (req, res) => {\n  device.registerDevice(req.params.sensorId).then((result) => {\n    if (!result) {\n      res.status(409).end();\n    } else {\n      res.json(result);\n    }\n  }).catch((error) => {\n    console.error(error);\n    res.status(409).end();\n  });\n});\n\nrouter.get('/device/:sensorId', (req, res) => {\n  device.getDevice(req.params.sensorId).then((result) => {\n    if (!result) {\n      res.status(404).end();\n    } else {\n      res.json(result);\n    }\n  }).catch((error) => {\n    console.error(error);\n    res.status(404).end();\n  });\n});\n\n\nmodule.exports = router;\n"]}